在 MongoDB 分片集群（Sharded Cluster）下，**可以对某个字段建立唯一索引，但有严格限制**：

---

## 1. 分片集群唯一索引的限制

### **必须包含分片键**
- 唯一索引字段**必须包含分片键**（shard key），且分片键要作为唯一索引的一部分。
- MongoDB 通过分片键确定数据分布，只有包含分片键的唯一索引才能保证全局唯一性。

### **不能只对非分片键字段建立唯一索引**
- 如果唯一索引**不包含分片键**，MongoDB无法保证唯一性，因为不同分片上的数据不会进行全局唯一性检查，只能保证每个分片内部唯一。

---

## 2. 官方示例

假设分片键是 `user_id`，你可以建立如下唯一索引：

```js
db.users.createIndex(
  { user_id: 1, email: 1 }, 
  { unique: true }
)
```

> 这里 `user_id` 是分片键，`email` 是你想唯一约束的字段。

---

## 3. 不能建立如下唯一索引：

```js
// 假设分片键是 user_id，不能只对 email 建唯一索引
db.users.createIndex(
  { email: 1 }, 
  { unique: true }
)
// 这样会报错：唯一索引必须包含分片键
```

---

## 4. 结论

- **MongoDB 分片集群下唯一索引必须包含分片键**，否则不能保证全局唯一性。
- 单字段唯一索引仅可用于分片键本身。如果你要对非分片键字段建立唯一约束，必须把分片键也加到唯一索引中。

---

如需分片方案、唯一索引设计建议或报错分析，可进一步提问！