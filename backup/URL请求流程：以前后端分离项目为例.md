
### 🌐 阶段一：URL 输入与 DNS 解析 (寻址)

1. **URL 输入与处理：** 用户在浏览器地址栏输入 URL（例如 `https://app.example.com/dashboard`），按下回车键。浏览器开始解析 URL。
2. **HSTS 检查：** 浏览器检查是否存在针对该域名的 HSTS 策略。如果存在，它会内部将 HTTP 协议升级为 HTTPS。
3. **DNS 域名解析：**
   * 浏览器检查​**本地缓存**​（浏览器缓存、Hosts 文件、本地 DNS 缓存）。
   * 若未命中，向配置的**本地 DNS 服务器**发起请求。
   * 本地 DNS 服务器通过**递归查询**和​**迭代查询**​（**根服务器** -> **TLD 服务器** -> ​**权威 DNS 服务器**​）获取 `app.example.com` 对应的 IP 地址。
   * 获取 IP 地址后，返回给浏览器。

---

### 🤝 阶段二：建立连接与发送请求 (前端服务)

1. **建立 TCP 连接：** 浏览器使用获取到的 IP 地址，通过**三次握手**与目标服务器建立 TCP 连接。
2. **HTTPS 握手 (TLS/SSL)：**
   * 如果 URL 是 HTTPS，浏览器和服务器进行 ​**TLS/SSL 握手**​，完成身份验证和密钥交换，建立加密通道。
3. **发送 HTTP 请求（获取 HTML/JS/CSS）：** 浏览器向目标服务器（通常是托管前端静态资源的 ​**CDN 或 Nginx 服务器**​）发送第一个 HTTP 请求：
   * `GET /dashboard HTTP/1.1`
4. **服务器响应（返回前端代码）：** Nginx/CDN 接收请求，查找并返回对应的 ​**HTML 文件**​。
   * 响应头部包含 Content-Type: `text/html`。
   * 响应体是 HTML 文件的内容，其中包含了 `<script>` 和 `<link>` 标签，指向打包好的 JavaScript 和 CSS 文件。

---

### 🖼️ 阶段三：前端渲染与数据请求

1. **浏览器解析与渲染：** 浏览器接收到 HTML 后，开始解析 HTML 结构（DOM 树）。
2. **资源加载：** 浏览器遇到 `<link>` 和 `<script>` 标签，会​**再次发起新的 HTTP 请求**​，去获取这些 CSS 和 JavaScript 静态资源。
   * 这些资源通常也托管在 Nginx/CDN 上。
3. **执行 JavaScript：** JavaScript 文件加载完成后，浏览器开始执行前端代码。此时，前端框架（如 React, Vue, Angular）接管页面控制权，并执行挂载逻辑。
4. **发起异步数据请求 (核心分离点)：** 前端应用意识到需要数据来填充页面，因此通过 **Ajax/Fetch** 向后端 API 服务器发起异步请求。
   * 例如：`GET https://api.example.com/api/v1/user/profile`。
   * 请求会携带 ​**认证信息**​（如 Cookie, Token 等）和必要的请求头。

---

### ⚙️ 阶段四：后端 API 处理与响应

1. **负载均衡与网关：** 异步请求首先到达后端集群前的 ​**负载均衡器**​（如 F5, LVS, Nginx）或 ​**API 网关**​。
   * 网关进行**身份验证、限流、日志记录**等统一处理。
   * 网关将请求路由到具体的​**后端服务实例**​（例如用户服务）。
2. **后端服务处理：**
   * **控制器 (Controller)：** Spring Boot 服务的 Controller 接收请求。
   * **业务逻辑 (Service)：** 调用 Service 层处理业务逻辑，可能涉及参数校验、状态判断等。
   * **数据库交互 (Repository)：** Service 层调用 Repository 访问 ​**数据库**​（如 MySQL、Redis）获取或存储数据。
3. **返回数据：** 后端服务将查询到的数据封装成 ​**JSON 格式**​。
   * 响应头部设置 Content-Type: `application/json`。
   * 将包含 JSON 数据的 HTTP 响应返回给前端。

---

### 🎨 阶段五：数据接收与最终页面呈现

1. **前端接收数据：** 浏览器中的 JavaScript 接收到后端的 JSON 响应数据。
2. **数据绑定与渲染：** 前端框架（例如 Vue/React）根据接收到的 JSON 数据，执行​**数据绑定**​，动态更新 DOM 元素。
3. **页面完成加载：** 所有关键数据和资源都已加载并渲染到页面上，用户看到完整的、交互式的界面。
4. **连接关闭：** 完成所有数据传输后，TCP 连接可能被关闭，或根据 `Connection: keep-alive` 保持一段时间以便处理后续请求。